{% extends "base_app.html" %}

{% block breadcrumb %}
  <li><a href="{% url 'employees_dashboard' %}">Home</a></li>
  <li><a href="{% url 'stocks_product_list' %}">Products</a></li>
  <li class="active">{{ object }}</li>
{% endblock %}

{% block content_app %}
  <div class="row">
    <div class="col-lg-5">
      <h2>Infos</h2>
      <dl class="dl-horizontal">
        <dt>Name</dt>
        <dd>{{ object.name }}</dd>
        <dt>Barcode</dt>
        <dd><object data="{% url 'stocks_product_barcode' object.id %}" type="image/svg+xml"></object></dd>
        <dt>Retail Price (RM)</dt>
        <dd>{{ object.retail_price|floatformat:"2" }}</dd>
        <dt>Lowest Retail Price (RM)</dt>
        <dd>{{ object.lowest_retail_price|floatformat:"2" }}</dd>
        {% if user.employee.work_in_hq %}
          <dt>Wholesale Price (RM)</dt>
          <dd>{{ object.wholesale_price|floatformat:"2" }}</dd>
          <dt>Lowest Wholesale Price (RM)</dt>
          <dd>{{ object.lowest_wholesale_price|floatformat:"2" }}</dd>
          <dt>Cost Price (RM)</dt>
          <dd>{{ object.cost_price|floatformat:"2" }}</dd>
        {% endif %}
      </dl>

      <p>
        {% if user.employee.hq %}
          {% if object.is_package %}
            <a href="{% url 'stocks_package_edit' object.id %}" class="btn btn-default">
              <span class="glyphicon glyphicon-edit"></span> Edit Info
            </a>
            <a href="{% url 'stocks_package_edit_price' object.id %}" class="btn btn-default">
              <span class="glyphicon glyphicon-edit"></span> Edit Prices
            </a>
          {% else %}
          <a href="{% url 'stocks_item_edit' object.id %}" class="btn btn-default">
            <span class="glyphicon glyphicon-edit"></span> Edit
          </a>
          {% endif %}
        {% endif %}
        <a href="{% url 'stocks_product_printing' object.id %}" target="_blank" class="btn btn-default">
          <span class="glyphicon glyphicon-barcode"></span> Print Barcode
        </a>
      </p>
    </div>

    <div class="col-lg-7">
      {% if object.is_package %}
        <h2>Content</h2>
        <p class="text-right">
          <a href="{% url 'stocks_packageitem_new' object.id %}" class="btn btn-default">
            <span class="glyphicon glyphicon-plus"></span> Add Item
          </a>
        </p>
        <table class="table table-striped table-responsive">
          <thead>
            <tr>
              <th>No</th>
              <th>Model</th>
              <th>Name</th>
              <th>Quantity</th>
              <th>&nbsp;</th>
            </tr>
          </thead>
          <tbody>
            {% for packitem in object.package.packageitem_set.all %}
              <tr>
                <td>{{ forloop.counter }}</td>
                <td>{{ packitem.item }}</td>
                <td>{{ packitem.item.name }}</td>
                <td>{{ packitem.quantity }} {{ packitem.item.unit_of_measure }}</td>
                <td>
                  <a href="{% url 'stocks_packageitem_edit' packitem.id %}">
                    <span class="glyphicon glyphicon-edit"></span> Edit
                  </a>
                </td>
              </tr>
            {% empty %}
              <tr>
                <td colspan="4">Empty</td>
              </tr>
            {% endfor %}
          </tbody>
        </table>
      {% endif %}
      {% if quantities %}
        <h2>Stocks</h2>
        <p class="text-right">
          {% if user.employee.hq %}
            <a href="{% url 'stocks_itemquantity_new' object.id %}" class="btn btn-default">
              <span class="glyphicon glyphicon-plus"></span> Adjust
            </a>
          {% else %}
            <a href="{% url 'stocks_itemquantitystore_new' object.id %}" class="btn btn-default">
              <span class="glyphicon glyphicon-plus"></span> Adjust
            </a>
          {% endif %}
        </p>
        <table class="table table-striped table-responsive">
          <thead>
            <tr>
              {% if user.employee.work_in_hq %}
                <th>Warehouse</th>
              {% endif %}
              <th>Time</th>
              <th class="text-right">Quantity</th>
              <th>Reason</th>
            </tr>
          </thead>
          <tbody>
            {% for obj in quantities %}
              <tr>
                {% if user.employee.work_in_hq %}
                  <td>{{ obj.warehouse }}</td>
                {% endif %}
                <td>{{ obj.datetime }}</td>
                <td class="text-right">{{ obj.quantity }}</td>
                <td>{{ obj.get_reason_display }}</td>
              </tr>
            {% endfor %}
          </tbody>
        </table>
      {% endif %}
    </div>
  </div>
{% endblock %}
