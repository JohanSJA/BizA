{% extends 'base_app_form.html' %}

{% block breadcrumb %}
  <li><a href='{% url "home" %}'>Home</a></li>
  <li>Retails</li>
  <li><a href='{% url "retails-sale-list" %}'>Sales</a></li>
  <li><a href='{% url "retails-sale-detail" form.instance.pk %}'>{{ form.instance.pk }}</a></li>
  <li class='active'>Close</li>
{% endblock %}

{% block content_app %}
  <div class='row'>
    <div class='col-lg-2'>
      <p class='text-right'><strong>Total (RM)</strong></p>
    </div>
    <div class='col-lg-6'>
      <p id='total_price'>{{ sale.total_price|floatformat:'2' }}</p>
    </div>
  </div>

  {{ block.super }}

  <div class='row'>
    <div class='col-lg-2'>
      <p class='text-right'><strong>Balance (RM)</strong></p>
    </div>
    <div class='col-lg-6'>
      <p id='balance'>&nbsp;</p>
    </div>
  </div>
{% endblock %}

{% block js %}
  function setBalance() {
    var total = $( '#total_price' ).text();
    var paid = $( '#id_amount_paid' ).val();
    var balance = paid - total;
    if ( balance < 0 ) {
      $( '#balance' ).text( 'Not enough' );
    } else {
      $( '#balance' ).text( balance.toFixed(2) );
    }
  }

  $( document ).ready(setBalance);

  $( '#id_amount_paid' ).keyup(setBalance);
{% endblock %}
